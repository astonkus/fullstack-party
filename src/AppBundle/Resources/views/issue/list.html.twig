{% extends 'base.html.twig' %}

{% block body %}
    <div class="container-fluid list__container">
        <div class="row list__row">
            <div class="list__left-side col-lg-6">
                <div class="row list__issues-row">
                    <div class="col-lg-12 list-filter">
                        {% set constNamespace = 'AppBundle\\Controller\\IssueController::' %}

                        <a
                            class="list-filter__open{% if app.request.get('state') != constant(constNamespace ~ 'STATE_CLOSED') %} active{% endif %}"
                            href="{{ path('issues', { 'state': constant(constNamespace ~ 'STATE_OPEN') }) }}"
                            title="{{ 'app.list.state.open'|trans }}">
                            {{ openIssuesCount }} {{ 'app.list.state.open'|trans }}
                        </a>
                        <a
                            class="list-filter__closed{% if app.request.get('state') == constant(constNamespace ~ 'STATE_CLOSED') %} active{% endif %}"
                            href="{{ path('issues', { 'state': constant(constNamespace ~ 'STATE_CLOSED') }) }}"
                            title="{{ 'app.list.state.closed'|trans }}">
                            {{ closedIssuesCount }} {{ 'app.list.state.closed'|trans }}
                        </a>
                    </div>
                    {% for issue in data %}
                        <div class="col-lg-12 white-block list__issue">
                            <div class="list__issue--icon">
                                <img src="{{ asset('assets/images/icons/ico-attention-green.png') }}" alt="attention icon"/>
                            </div>
                            <div class="list__issue--content">
                                <div>
                                    <a href="{{ path(
                                    'issue',
                                    {
                                        'owner': issue.owner,
                                        'repo': issue.repo,
                                        'number': issue.number,
                                        'page': app.request.get('page')
                                    }
                                    ) }}" title="{{ issue.title }}" class="list__issue--title">
                                        {{ issue.title }}</a>

                                    {% for label in issue.labels %}
                                        <span class="label" style="background-color: #{{ label.color }}">{{ label.name }}</span>
                                    {% endfor %}
                                </div>
                                <div class="list__issue--time">
                                    #{{ issue.number }} {{ 'app.list.opened'|trans }} {{ issue.createdAt|ago }} {{ 'app.list.by'|trans }}
                                    <a href="{{ issue.user_html_url }}" target="_blank" title="{{ issue.user }}"><span>{{ issue.user }}</span></a>
                                </div>
                            </div>
                            <div class="list__issue--comment">
                                <a href="{{ path(
                                'issue',
                                {
                                    'owner': issue.owner,
                                    'repo': issue.repo,
                                    'number': issue.number,
                                    'page': app.request.get('page')
                                }
                                ) }}">
                                    <span>{{ issue.commentsCount }}</span></a>

                            </div>
                        </div>
                    {% endfor %}
                </div>
                <div class="row">
                    <div class="col-lg-12">
                        {% include '@App/pagination/index.html.twig' with {
                        currentFilters: { },
                        currentPage: currentPage,
                        paginationPath: "issues",
                        lastPage: pageCount,
                        showAlwaysFirstAndLast: true
                        } only %}
                    </div>
                </div>
            </div>
            <div class="list__right--side col-lg-6">
                <div class="row list__right-side--wrapper">
                    <div class="list__right-side--title">
                        <h1>{{ 'app.list.full_stack_title'|trans }}</h1>
                    </div>
                    <div>
                        <img src="{{ asset('assets/images/logo-white-small.png') }}" alt="logo">
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
